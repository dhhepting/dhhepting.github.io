{% comment %}
{% endcomment %}
{% assign url_parts = turl | split: '/' %}
{% assign sem_size = 4 %}
{% assign crsoffs = "" %}
{% assign crs_ids = "" %}
{% for sp in site.pages %}
  {% if sp.url contains "teaching" %}
    {% assign url_parts = sp.url | split: '/' %}
    {% if url_parts.size == sem_size %}
      {% assign crs_id = url_parts[2] %}
      {% assign crs_part = crs_id | split: '-' %}
      {% if crs_part.size == 2 and crs_part[0] == "CS" %}
        {% assign crsoff = url_parts | last %}
        {% if crsoff contains "2" %}
          {% capture crsoff_url %}{{crsoff}}/{%endcapture%}
          {% capture crs_url  %}{{ sp.url | remove: crsoff_url }}{%endcapture%}
          {% capture crs_ids %}{{crs_ids}}|{{crs_url}}#{{crs_id}}{% endcapture %}
          {% capture crsoffs %}{{crsoffs}}|{{crs_id}}#{{crsoff}}{% endcapture %}
        {% endif %}
      {% endif %}
    {% endif %}
  {% endif %}
{% endfor %}

{% assign sortedcrsoffs = crsoffs | split: '|' | sort %}
{% assign sortedcrs_ids = crs_ids | split: '|' | uniq | sort %}
{% capture numcourses %}{{ sortedcrs_ids.size | minus:1 }}{% endcapture %}
{% capture numoffs %}{{ sortedcrsoffs.size | minus:1 }}{% endcapture %}

<div class="card my-2" id="teach-info-card">
  <h3 class="card-header text-center">Courses Taught</h3>
  <div class="card-body">
    <ul class="list-group list-group-flush">
      {% for i in (1..numcourses) %}
          {%- assign cc = sortedcrs_ids[i] | split: '#' -%}
          {%- assign crs_name = "" -%}
          {%- for crs in site.data.teaching.courses -%}
            {%- if crs.id == cc[1] -%}
      	      {%- assign crs_name = crs.name -%}
              {% break %}
            {%- endif -%}
          {%- endfor -%}
          {% if crs_name %}
      <li class="list-group-item">
        <a href="{{ cc[0] | relative_url }}">
          {{cc[1] | replace: "-"," "}} : {{crs_name}}
        </a>
        ( &nbsp;
        {% for j in (1..numoffs) %}
          {%- assign co = sortedcrsoffs[j] | split: '#' -%}
          {%- if cc[1] == co[0] -%}
            {{ co[1] }} &nbsp;
          {%- endif -%}
        {%- endfor -%}
        )
      </li>
      {%- endif -%}
  {% endfor %}
    </ul>
  </div>
</div>
